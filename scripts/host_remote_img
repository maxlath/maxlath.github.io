#!/usr/bin/env coffee
require 'colors'
cb = require('copy-paste').copy
request = require 'request'
fs = require 'fs'
[ url, name... ] = process.argv.slice(2)
name = name.join('-')
_ = require '../lib/utils'


unless url? then throw new Error('missing url')
unless name? then throw new Error('missing name')

request.get url, (err, res)->
  if err? then _.throwError err, url
  else
    url = getImgUrl(name)
    path = ".#{url}"
    _.writeFile path, res.body
    cb url
    console.log 'added to clipboard'.green, url


getImgUrl = (name)->
  unless /\./.test name then name = name + '.jpg'
  "/assets/img/#{name}"
